\documentclass[10pt, a4paper]{article}

%\usepackage[paper=a4paper, left=1.5cm, right=1.5cm, bottom=1.5cm, top=3.5cm]{geometry}
\usepackage[paper=a4paper]{geometry}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{latexsym}
\usepackage{lastpage}
\usepackage[colorlinks=true, linkcolor=blue]{hyperref}
\usepackage{calc}
\usepackage{paralist}
\usepackage{caratula}
%\usepackage[plain,noline,linesnumberedhidden, noend]{algorithm2e}
%\usepackage[plain,noline,linesnumbered, noend]{algorithm2e}
\usepackage[plain,noline,noend]{algorithm2e}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{float}

\newcommand{\f}[1]{\text{#1}}
\newcommand{\call}[1] {\textsc{#1}}
\newcommand{\tab}[1]{\Indp \Indp #1 \Indm  \Indm}
\newcommand{\tabSpace}[1]{\Indp \Indp \; #1 \Indm \Indm \;}
\newcommand{\si}[2]{ {\bf si} (#1)\; \tab {#2} }
\newcommand{\sino}[1]{ {\bf sino}\; \tab {#1} }
\newcommand{\sinosi}[2]{ {\bf sino, si #1}\; \tab {#2} }
\newcommand{\mientras}[2] {  {\bf mientras} (#1) \; \tabSpace  {#2} }
\newcommand{\funcion}[3] { 	\KwSty{\call{#1}(#2)}\; \tabSpace  {#3} \KwSty{\call{Fin Funcion}} \newline }
\newcommand{\funcionConResultado}[4] {      \KwSty{\call{#1}(#2) $\rightarrow$ #3}\; \tabSpace  {#4} \KwSty{\call{Fin Funcion}} \newline }
\newcommand{\porcada}[3] { {\bf por cada } #1 {\bf en} #2 \; \tabSpace {#3} }
\newcommand{\para}[4] { {\bf para } #1 {\bf desde} #2 {\bf hasta} #3\; \{ \; \tab{#4}\}\; }
\newcommand{\paracada}[3] { {\bf para cada } #1 {\bf $\in$} #2 \; \tabSpace {#3} }
\newcommand{\devolver}[1] { {\bf devolver} #1\;}



\sloppy


\hypersetup{%
 % Para que el PDF se abra a pagina completa.
 pdfstartview= {FitH \hypercalcbp{\paperheight-\topmargin-1in-\headheight}},
 pdfauthor={C\'atedra de Algoritmos y Estructuras de Datos III - DC - UBA},
 pdfkeywords={Trabajo Pr\'actico 3},
 pdfsubject={}
}

\parskip=5pt % 10pt es el tama\~no de fuente

% Pongo en 0 la distancia extra entre itemes.
\let\olditemize\itemize
\def\itemize{\olditemize\itemsep=0pt}

% Acomodo fancyhdr.
\pagestyle{fancy}
\thispagestyle{fancy}
\addtolength{\headheight}{1pt}
\lhead{Base de Datos}
\rhead{TP1}
\cfoot{\thepage /\pageref{LastPage}}
\renewcommand{\footrulewidth}{0.4pt}

\author{Base de Datos, DC, UBA.}
\date{}
\title{}

\begin{document}

%Pagina de titulo e indice
\thispagestyle{empty}
\materia{Base de datos}
\submateria{TP1}
\titulo{}
\grupo{NN\_3}
\integrante{Sergio Gonz\'alez}{723/10}{sergiogonza90@gmail.com}
\integrante{Gino Scarpino}{392/08}{gino.scarpino@gmail.com}
\maketitle

\tableofcontents

\SetAlgoSkip{bigskip}
\NoCaptionOfAlgo
\DontPrintSemicolon
\SetAlFnt{\ttfamily}

\newpage

\section{Introduccion}

	\input{./intro.tex}
 
\section{Modelo entidad Relaci\'on}

Para hacer el modelo, utilizamos la notaci\'on vista en la materia, excepto por las carnalidades donde se representan de manera distinta. As\'i por ejemplo, una relaci\'on M:N ser\'a algo de la forma:

\begin{figure}[ht]
  \begin{center}
    \includegraphics[scale=.75]{./imagenes/ejrelacion.jpg}
    \caption{relacion M:N} 
    \label{fig:graficomn}
  \end{center}
\end{figure}

Una relacion N:1 sera algo de la forma:

\begin{figure}[ht]
  \begin{center}
    \includegraphics[scale=.75]{./imagenes/ejrelacion2.jpg}
    \caption{relacion N:1} 
    \label{fig:grafico}
  \end{center}
\end{figure}

\newpage

\section{Diagrama Entidad Relaci\'on (DER)}

	\subsection{Breve descripcion de las entidades}

		\input{./descripciones_entidades.tex}

	\newpage
	\subsection{DER}

		Debido al gran tama\~no del diagrama, lo separamos en dos fragmentos de manera de hacerlo m\'as legible. Ambas partes pueden leerse de manera independiente y est\'an centradas en la entidad Legislador.
			
		\begin{figure}[H]
		  \begin{center}
		    \includegraphics[scale=.40,angle=-90]{./imagenes/DER2-arriba.jpg}
		    \caption{fragmento der} 
		    \label{fig:derparte1}
		  \end{center}
		\end{figure}
				
		\begin{figure}[H]
		  \begin{center}
		    \includegraphics[scale=.35,angle=-90]{./imagenes/DER2-abajo.jpg}
		    \caption{fragmento der segunda parte} 
		    \label{fig:derparte2}
		  \end{center}
		\end{figure}

	\newpage
	\subsection{Restricciones}
	
		\input{restricciones.tex}

\section{Modelo Relacional}

En esta secci\'on plasmamos el modelo relacional que se deriva del DER anterior. Usamos la notaci\'on que se estudi\'o en el apunte de modernizaci\'on otorgado por la c\'atedra.

	\input{modelo_relacional.tex}

\section{Condiciones asumidas del enunciado}

En esta secci\'on presentamos algunas presunciones que hicimos producto de algunas omisiones en el enunciado o simplemente cosas que hacen al sentido com\'un de la realidad que se pretend\'ia modelar.

\begin{enumerate}
	\item Asumimos que una Provincia podr\'ia tener menos de 33000 habitantes.

	\item Un bloque representa siempre al mismo partido pol\'itico.
	\item Las acciones se miden en una cantidad que es un numero entero y tiene un valor en una moneda fija.
	\item Los votos son por sesi\'on y los presentes votan todos juntos. 
	\item El empleado que realiza el control de calidad, no es un legislador, ni tampoco lo fue o estuvo como legislador en la historia que guarda el modelo.	
\end{enumerate}


\section{Aclaraciones de diferencias entre el DER, MR y el Schema SQL}

Cuando el equipo se encontr\'o en la tarea de desarrollar las consultas en SQL as\'i como el Schema, se tomaron algunas libertades con el fin de que se m\'as razonable y simple a la hora de hacer las consultas. Estas simplificaciones si bien no hacen grandes cambios a lo que es el modelo pertinente de la realidad, no coinciden en su totalidad con el diagrama DER. 

Algunas de las modificaciones efectuadas fueron:

En el DER se hace distinci\'on entre diputados y senadores, si bien a priori nos resulta muy representativo y modela la realidad que pretend\'iamos, nos encontramos con que en el momento de llevarlo a tablas cont\'abamos con una tabla para legisladores y otras para diputados y senadores con sus foreign keys respectivas. Esto nos pareci\'o un poco molesto y dif\'icil de comprender incluso tal vez a la hora de la correcci\'on por parte del docente, por ello decidimos tener una tabla legislador con el tipo, a pesar de conservar la idea original en el DER. 
Entendemos no obstante que el tipo NO ES un atributo del legislador ni mucho menos en el DER.

Otro cambio similar es el de las c\'amaras de diputados y senadores, dado que existe una sola c\'amara de cada uno y es evidente que en ellas habr\'a solo senadores o solo diputados, decidimos que la tabla tenga el tipo de c\'amara.

\section{Resolucion de consultas y Schema}

Los scripts con la resoluci\'on de las consultas y creaci\'on de esquemas de tablas est\'an en los archivos:

\begin{itemize}

	\item QUERIES.sql
	\item SCHEMA.sql
	\item TRIEGGER.sql
	\item DATOS.sql

\end{itemize}

No introducimos su contenido aqu\'i debido a que son muy extensos y su finalidad es ser ejecutado en el motor de base de datos. 

\begin{itemize}
	\item SCHEMA.sql genera la estructura de la base de datos.
	\item TRIEGGER.sql contiene un triegger que se ejecuta ante la actualizaci\'on de un proyecto. Necesario para la resoluci\'on de una de las consignas.
	\item DATOS.sql introduce datos generaros aleatoriamente para poder probar la base de datos y las queries solicitadas.
	\item QUERIES.sql contiene las queries solicitadas por la consigna.
\end{itemize}
El orden de ejecuci\'on es el mismo que el orden en que acabamos de exponerlas.

\end{document}